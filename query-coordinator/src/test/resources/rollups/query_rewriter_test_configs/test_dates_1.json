{
  "schemas": {
    "_": {
      "dxyz-num1": ["number", "number1"],
      ":wido-ward": ["number", "ward"],
      "crim-typ3": ["text", "crime_type"],
      "dont-roll": ["text", "dont_create_rollups"],
      "crim-date": ["floating_timestamp", "crime_date"],
      "some-date": ["floating_timestamp", "some_date"]
    }
  },
  "rollups": {
    "r_ymd": "SELECT date_trunc_ymd(crime_date), ward, count(*) GROUP BY date_trunc_ymd(crime_date), ward",
    "r_ym": "SELECT date_trunc_ym(crime_date), ward, count(*) GROUP BY date_trunc_ym(crime_date), ward",
    "r_y": "SELECT date_trunc_y(crime_date), ward, count(*) GROUP BY date_trunc_y(crime_date), ward",
    "r_sca_ymd": "SELECT date_trunc_ymd(crime_date), sum(number1), count(number1), avg(number1) GROUP BY date_trunc_ymd(crime_date)",
    "r_arithmetic_outside_aggregate_ymd": "SELECT date_trunc_ymd(crime_date), sum(number1)*60, count(number1), avg(number1), ward GROUP BY date_trunc_ymd(crime_date), ward"
  },
  "tests": [
    {
      "query": "SELECT ward, count(*) AS count WHERE crime_date BETWEEN date_trunc_ymd('2011-02-01') AND date_trunc_ymd('2012-05-02') GROUP BY ward",
      "rewrites": {
        "r_ymd": "SELECT c2 as ward, coalesce(sum(c3), 0) as count WHERE c1 BETWEEN date_trunc_ymd('2011-02-01') AND date_trunc_ymd('2012-05-02') GROUP BY c2"
      }
    }
  ]
}
